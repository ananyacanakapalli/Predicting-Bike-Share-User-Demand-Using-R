---
title: "PREDICTING BIKE SHARE USER DEMAND"
output: html_document
date: "2024-04-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
##Loading Libraries
```{r}
library(dplyr)
library(ggplot2)
library(tidyr)
library(tidyverse)
library(reshape2)
```

##Loading the dataset
```{r}
biker<-read.csv(file.choose())
View(biker)

```

## Data Structure of the Dataset
```{r}
str(biker)
```

## Checking NA values
```{r}
colSums(is.na(biker))
```


## Changing the Datatype of dteday into Date Format
```{r}
biker$dteday <- as.Date(biker$dteday, format="%d-%m-%Y")
```


```{r}
str(biker)
```

## Performing data cleaning by removing yr column and dropping 'biker' column
```{r}
biker[, 'yr']<- NULL
```

```{r}
head(biker)
```

## Checking for outliers
```{r}
x <- melt(biker)

plt <- ggplot(data = x, aes(x = variable, y = value))
plt + geom_boxplot() + theme_minimal() + labs(x = "Title", y = "x")
```

```{r}
lapply(seq_along(biker), function(x){
 boxplot(biker[[x]], main = paste("Title", colnames(biker))[[x]])
})
```

Linear Regression Analysis

Creating a linear regression model for 'registered' variable
```{r}
registered_model <- lm(registered ~ ., data = biker)
summary(registered_model)

```

Creating a linear regression model for 'casual' variable
```{r}
casual_model <- lm(casual ~ ., data = biker)
summary(casual_model)

```

Creating a linear regression model for 'count' variable
```{r}
count_model <- lm(cnt ~ ., data = biker)
summary(count_model)
```

Performing Time-Series Analysis to plot historical trends of bike share users over time
```{r}
ggplot(data = biker, aes(x = dteday, y = cnt)) +
  geom_line() +
  labs(x = "Date", y = "Count of Bike Share Users") +
  ggtitle("Historical Trends of Bike Share Users Over Time")
```

Explore distribution of bike share users across various factors

Seasons
```{r}
ggplot(data = biker, aes(x = factor(season), y = cnt)) +
  geom_boxplot() +
  labs(x = "Season", y = "Count of Bike Share Users") +
  ggtitle("Distribution of Bike Share Users by Season")
```

Months
```{r}
ggplot(data = biker, aes(x = factor(mnth), y = cnt)) +
  geom_boxplot() +
  labs(x = "Month", y = "Count of Bike Share Users") +
  ggtitle("Distribution of Bike Share Users by Month")

```

Weekdays
```{r}
ggplot(data = biker, aes(x = factor(weekday), y = cnt)) +
  geom_boxplot() +
  labs(x = "Weekday", y = "Count of Bike Share Users") +
  ggtitle("Distribution of Bike Share Users by Weekday")

```

Holidays
```{r}
ggplot(data = biker, aes(x = factor(holiday), y = cnt)) +
  geom_boxplot() +
  labs(x = "Holiday", y = "Count of Bike Share Users") +
  ggtitle("Distribution of Bike Share Users on Holidays")
```



```{r}
# Scatter plot with regression lines for temperature and bike share usage
ggplot(data = biker, aes(x = temp, y = cnt)) +
  geom_point(alpha = 0.5) +  # Add points
  geom_smooth(method = "lm", se = FALSE, color = "blue") +  
  labs(x = "Temperature", y = "Count of Bike Share Users") +
  ggtitle("Relationship Between Temperature and Bike Share Usage")

# Scatter plot with regression lines for humidity and bike share usage
ggplot(data = biker, aes(x = hum, y = cnt)) +
  geom_point(alpha = 0.5) +  # Add points
  geom_smooth(method = "lm", se = FALSE, color = "green") +
  labs(x = "Humidity", y = "Count of Bike Share Users") +
  ggtitle("Relationship Between Humidity and Bike Share Usage")

# Scatter plot with regression lines for windspeed and bike share usage
ggplot(data = biker, aes(x = windspeed, y = cnt)) +
  geom_point(alpha = 0.5) +  # Add points
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(x = "Windspeed", y = "Count of Bike Share Users") +
  ggtitle("Relationship Between Windspeed and Bike Share Usage")

```

